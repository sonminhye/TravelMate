<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
						"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="chat">	
	
	<select id="showChatRooms" resultType="com.travel.mate.dto.ChatRoomDTO" parameterType="int" >
		select r.roomCode, r.userCode as receiverCode, userDetail.name as receive, messageRoom.latestdate
		from
		(select * from roomUser where roomCode in (select roomCode from roomUser where userCode=#{userCode}) and userCode!=#{userCode}) as r 
			join userDetail 
			join messageRoom
		where r.userCode = userDetail.userCode and r.roomCode = messageRoom.roomCode
	</select>
	
	<select id="showChatRoomExist" resultType="com.travel.mate.dto.ChatRoomDTO" parameterType="com.travel.mate.dto.ChatRoomDTO">
		select * 
		from roomUser 
		where roomCode in (select roomCode from roomUser where userCode=#{senderCode}) 
		and userCode=#{receiverCode}
	</select>
	
</mapper>